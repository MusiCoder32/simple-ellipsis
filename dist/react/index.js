import React,{useRef,useEffect,useCallback}from"react";function getClientSize(){return window.innerWidth?{w:window.innerWidth,h:window.innerHeight}:"BackCompat"===document.compatMode?{w:document.body.clientWidth,h:document.body.clientHeigth}:{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}}function openEllipsis(n,d,s){let e=!1;if("always"===s)e=!0;else if("multiple"===s){if(!(n.scrollHeight>n.offsetHeight))return}else if(!isOverFlow(n))return;var{innerText:s,clientWidth:p,clientHeight:b}=n,{w:f,h}=getClientSize(),{left:c,top:m,bottom:u,right:g}=n.getClientRects()[0];let x;if(x=(x=e&&n.getAttribute("ell-value")||s)||n.querySelector("input").value){n.setAttribute("ell-value",x);s=n.style.cssText.split(";");let l={};s.forEach(e=>{e=e.split(":");l[e[0]]=e[1]});var v,s=window.getComputedStyle(n,":after"),w=parseInt(s.width),y=parseInt(window.getComputedStyle(document.documentElement).getPropertyValue("--ell-max-width"));y<=w?(l["--ell-wrap"]="pre-wrap",l["--ell-min-width"]=y,l["--ell-width"]=y):l["--ell-width"]=s.width,l["--ell-wrap"]="pre-wrap";let e="";for(v in l)e+=v+":"+l[v]+";";n.style.cssText=e;var k,{paddingBottom:w,paddingLeft:y,paddingRight:s,paddingTop:M,height:z,width:C,borderWidth:E}=window.getComputedStyle(n,":after"),L={paddingBottom:w,paddingLeft:y,paddingRight:s,paddingTop:M,height:z,width:C,borderWidth:E};for(k in L)L[k]=parseInt(L[k]);var R,{paddingBottom:w,paddingLeft:y,paddingRight:s,paddingTop:M,height:z,width:C,borderWidth:E}=L,W=C+y+s+2*(E=E||0),T=z+M+w+2*E,C=window.getComputedStyle(n,":before"),q=parseInt(C.width)+2*parseInt(C.borderWidth);c-W-q<0&&"left"===d&&(d="right"),f<g+W+q&&"right"===d&&(d="left"),m-T-q<0&&"top"===d&&(d="bottom");let t=5,r=5,o=9;switch(d=h<u+T+q&&"bottom"===d?"top":d){case"top":t=c-(W-p)/2,t=Math.max(t,5),t=Math.min(t,f-W-5),l["--ell-left"]=t+"px",l["--ell-top"]=m-T-q/2*Math.sqrt(2)+"px",l["--ell-angle-left"]=c+p/2-q/2+"px",l["--ell-angle-top"]=m-q-q/2*(Math.sqrt(2)-1)+"px";break;case"bottom":t=c-(W-p)/2,t=Math.max(t,5),t=Math.min(t,f-W-5),l["--ell-left"]=t+"px",l["--ell-top"]=u+q/2*Math.sqrt(2)+"px",l["--ell-angle-left"]=c+p/2-q/2+"px",l["--ell-angle-top"]=u+q/2*(Math.sqrt(2)-1)+"px";break;case"right":r=m-(T-b)/2,r=Math.max(r,5),r=Math.min(r,h-T-5),o=m+(b-q)/2,o=Math.max(o,9),o=Math.min(o,h-2*q-9),l["--ell-left"]=g+q/2*Math.sqrt(2)+"px",l["--ell-top"]=r+"px",l["--ell-angle-left"]=g+q/2*(Math.sqrt(2)-1)+"px",l["--ell-angle-top"]=o+"px";break;case"left":r=m-(T-b)/2,r=Math.max(r,5),r=Math.min(r,h-T-5),o=m+(b-q)/2,o=Math.max(o,9),o=Math.min(o,h-2*q-9),l["--ell-left"]=c-W-q/2*Math.sqrt(2)+"px",l["--ell-top"]=r+"px",l["--ell-angle-left"]=c-q-q/2*(Math.sqrt(2)-1)+"px",l["--ell-angle-top"]=o+"px"}let i="";for(R in l)-1<R.indexOf("--")&&(i+=R+":"+l[R]+";");let a=document.getElementById("simply-ellipsis-tooltip");a||((a=document.createElement("div")).setAttribute("id","simply-ellipsis-tooltip"),document.body.append(a)),a.setAttribute("ell-value",x),a.style.cssText=i,a.classList.remove("has-ell-left","has-ell-right","has-ell-top","has-ell-bottom"),a.classList.add("has-ell-"+d),a.classList.add("has-ell"),a.classList.add("has-ell-visibility")}}function isOverFlow(l){if(l.scrollWidth>l.offsetWidth)return!0;let t;if(l.children?.length)for(let e=0;e<l.children.length;e++){var r=l.children[e];if(t=isOverFlow(r))break}return t}function styleInject(e,l){var t,r,l=(l=void 0===l?{}:l).insertAt;e&&"undefined"!=typeof document&&(t=document.head||document.getElementsByTagName("head")[0],(r=document.createElement("style")).type="text/css","top"===l&&t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)))}var css_248z='html,html[data-ellipsis=antd-dark]{--ell-max-width:350px;--ell-background:#404040;--ell-font-size:14px;--ell-padding:6px 8px;--ell-line-height:22px;--ell-color:#fff;--ell-border-radius:2px;--ell-border-color:none;--ell-border-size:0}html[data-ellipsis=element-dark]{--ell-max-width:350px;--ell-background:#303133;--ell-font-size:12px;--ell-padding:5px 11px;--ell-line-height:20px;--ell-color:#fff;--ell-border-radius:4px;--ell-border-color:none;--ell-border-size:0}html[data-ellipsis=element-light]{--ell-max-width:350px;--ell-background:#fff;--ell-font-size:12px;--ell-padding:5px 11px;--ell-line-height:20px;--ell-color:#303133;--ell-border-radius:4px;--ell-border-color:#e4e7ed;--ell-border-size:1px}.has-ell{--ell-left:0;--ell-top:0;--ell-angle-left:0;--ell-angle-top:0;--ell-wrap:nowrap;--ell-width:0;--ell-min-width:0;position:relative}.ell-a-b:before,.ell-a-l:before,.ell-a-r:before,.ell-a-t:before,.ell-b:before,.ell-l:before,.ell-m-b:before,.ell-m-l:before,.ell-m-r:before,.ell-m-t:before,.ell-r:before,.ell-t:before,.elln-b:before,.elln-l:before,.elln-r:before,.elln-t:before,.has-ell:before{background-color:var(--ell-background);border:var(--ell-border-size) solid var(--ell-border-color);box-sizing:content-box;height:8px;width:8px}.ell{box-sizing:content-box!important;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ell-a-b:after,.ell-a-l:after,.ell-a-r:after,.ell-a-t:after,.ell-b:after,.ell-l:after,.ell-m-b:after,.ell-m-l:after,.ell-m-r:after,.ell-m-t:after,.ell-r:after,.ell-t:after,.elln-b:after,.elln-l:after,.elln-r:after,.elln-t:after{border:var(--ell-border-size) solid var(--ell-border-color);border-radius:var(--ell-border-radius);box-sizing:content-box!important;color:var(--ell-color);content:attr(ell-value);font-size:var(--ell-font-size);left:0;line-height:var(--ell-line-height);max-width:var(--ell-max-width);min-width:var(--ell-min-width);padding:var(--ell-padding);position:fixed;top:0;visibility:hidden;white-space:var(--ell-wrap);word-break:break-all}.ell-a-b:before,.ell-a-l:before,.ell-a-r:before,.ell-a-t:before,.ell-b:before,.ell-l:before,.ell-m-b:before,.ell-m-l:before,.ell-m-r:before,.ell-m-t:before,.ell-r:before,.ell-t:before,.elln-b:before,.elln-l:before,.elln-r:before,.elln-t:before{content:"";left:0;position:fixed;top:0;visibility:hidden}.ell-a-b,.ell-a-l,.ell-a-r,.ell-a-t,.ell-b,.ell-l,.ell-r,.ell-t{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ell-m-b,.ell-m-l,.ell-m-r,.ell-m-t,.elln-b,.elln-l,.elln-r,.elln-t{-webkit-box-orient:vertical;-webkit-line-clamp:var(--ell-line);display:-webkit-box;overflow:hidden;word-break:break-all}.has-ell:after{background-color:var(--ell-background);border:var(--ell-border-size) solid var(--ell-border-color);border-radius:var(--ell-border-radius);color:var(--ell-color);content:attr(ell-value);font-size:var(--ell-font-size);left:var(--ell-left);line-height:var(--ell-line-height);max-width:var(--ell-max-width);padding:var(--ell-padding);text-align:left;top:var(--ell-top);white-space:var(--ell-wrap);width:var(--ell-width);word-break:break-all;z-index:9999}.has-ell:after,.has-ell:before{box-sizing:content-box!important;position:fixed;transition:visibility .1s;visibility:hidden}.has-ell:before{content:"";left:var(--ell-angle-left);top:var(--ell-angle-top);transform:rotate(45deg);z-index:10000}.has-ell-top:before{border-bottom-right-radius:2px}.has-ell-bottom:before{border-top-left-radius:2px}.has-ell-left:before{border-top-right-radius:2px}.has-ell-right:before{border-bottom-left-radius:2px}.has-ell-hidden{visibility:hidden}.has-ell-visibility:after,.has-ell-visibility:before{visibility:visible!important}.has-ell-top:before{border-left-color:transparent;border-top-color:transparent}.has-ell-bottom:before{border-bottom-color:transparent;border-right-color:transparent}.has-ell-right:before{border-right-color:transparent;border-top-color:transparent}.has-ell-left:before{border-bottom-color:transparent;border-left-color:transparent}.has-ell:hover:after,.has-ell:hover:before{visibility:visible}';styleInject(css_248z);let placementMap={left:"l",right:"r",bottom:"b",top:"t"};function index({placement:e="top",always:l,title:t,line:r,children:o}){let i=useRef(placementMap[e]||"t"),a=useRef(),n=useRef(),d=useRef();useEffect(()=>{d.current&&(n.current=d.current,l?(a.current="always",n.current.classList.add("ell-a-"+i.current),t&&n.current.setAttribute("ell-value",t)):"number"==typeof r&&0<r?(a.current="multiple",n.current.classList.add("ell-m-"+i.current),n.current.style.setProperty("--ell-line",r)):n.current.classList.add("ell-"+i.current))},[l,r,t]);var s=useCallback(()=>{openEllipsis(n.current,e,a.current)},[e]),p=useCallback(()=>{var e=document.getElementById("simply-ellipsis-tooltip");e&&e.classList.remove("has-ell-visibility")},[]);return o?React.cloneElement(o,{onMouseOver:s,onMouseLeave:p,ref:d}):null}export default index;
